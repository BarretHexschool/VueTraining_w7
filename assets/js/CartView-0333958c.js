import{c as h}from"./useCartStore-70f59069.js";import{s as S}from"./useSweetAlertStore-db5267d6.js";import{a as E,m as b}from"./index-9dbfbed6.js";import{b6 as V,av as d,aj as n,l,m as t,F as x,at as T,s as p,aJ as c,k as _,t as a,b1 as $,a5 as L,r as A,a3 as y,b3 as D}from"./_plugin-vue_export-helper-68081c38.js";import{L as P}from"./LoadingDesign-df3df60d.js";import{E as B,a as I,F as U}from"./vee-validate.esm-51f435e3.js";import{l as O}from"./runtime-dom.esm-bundler-eb0e3820.js";import"./axios-aba6f0e0.js";import"./vue-router-e29dd812.js";const R={data(){return{loadingItem:""}},computed:{...E(h,["carts","finalTotal"])},methods:{...b(h,["getCartData","deleteOneCart","swalClearAllCart"]),...b(S,["swalError","swalToastTopEnd"])},mounted(){this.getCartData()}},M={class:"table align-middle w-100 border-secondary p-1"},N=t("thead",null,[t("tr",{class:"w-100"},[t("th",null,"品名"),t("th",{class:"text-nowrap text-center"},"單價"),t("th",{class:"text-nowrap text-center"},"數量"),t("th",{class:"text-nowrap text-center"},"小計"),t("th")])],-1),q={class:"w-100"},j={key:0},z=t("br",null,null,-1),H={key:1,class:"text-success"},W={class:"text-center"},J={class:"text-center"},G={class:"text-center"},K={class:"text-end"},Q=["onClick","disabled"],X={key:0,class:"fas fa-spinner fa-pulse"},Y={class:"border-transparent"},Z=t("td",{colspan:"4",class:"text-end border-0"},"總計",-1),tt={class:"text-end border-0"},et={class:"d-flex justify-content-between mb-4"};function st(r,e,m,C,o,u){const f=d("RouterLink");return n(),l(x,null,[t("table",M,[N,t("tbody",q,[r.carts?(n(!0),l(x,{key:0},T(r.carts,s=>(n(),l("tr",{key:s.id},[t("td",null,[p(c(s.product.title)+" ",1),s.message?(n(),l("span",j,[z,p("*"+c(s.message),1)])):_("",!0),s.coupon?(n(),l("div",H,"已套用優惠券")):_("",!0)]),t("td",W,c(s.product.price),1),t("td",J,c(s.qty),1),t("td",G,c(s.total),1),t("td",K,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:k=>r.deleteOneCart(s.id),disabled:s.id===o.loadingItem},[o.loadingItem===s.id?(n(),l("i",X)):_("",!0),p(" x ")],8,Q)])]))),128)):_("",!0)]),t("tfoot",Y,[t("tr",null,[Z,t("td",tt,c(r.finalTotal),1)])])]),t("div",et,[t("button",{class:"btn btn-danger",type:"button",onClick:e[0]||(e[0]=(...s)=>r.swalClearAllCart&&r.swalClearAllCart(...s))}," 清空商品 "),a(f,{class:"btn btn-secondary",type:"button",to:"/products"},{default:$(()=>[p("想點更多")]),_:1})])],64)}const ot=V(R,[["render",st]]),at={props:{currentState:{type:String,required:!0}},computed:{progressBarWidth(){return this.currentState==="選擇餐點"?"0%":this.currentState==="訂購資料"?"33.33%":this.currentState==="餐點準備中"?"66.66%":"0%"},progressBarValue(){return this.currentState==="選擇餐點"?"0":this.currentState==="訂購資料"?"33.33":this.currentState==="餐點準備中"?"66.66":"0"}}},rt={class:"position-relative m-5"},nt={class:"progress bg-third",style:{height:"2px"}},lt=["aria-valuenow"],it=A('<button type="button" class="position-absolute top-0 start-0 translate-middle btn btn-sm btn-danger rounded-pill text-white" style="width:1rem;height:1rem;"></button><p class="position-absolute top-0 start-0 translate-middle pt-6 fs-7 fw-bold"> 選擇餐點 </p><button type="button" class="position-absolute top-0 start-33 translate-middle btn btn-sm btn-danger rounded-pill text-white" style="width:1rem;height:1rem;"></button><p class="position-absolute top-0 start-33 translate-middle pt-6 fs-7 fw-bold"> 訂購資料 </p><button type="button" class="position-absolute top-0 start-66 translate-middle btn btn-sm btn-third rounded-pill text-white" style="width:1rem;height:1rem;"></button><p class="position-absolute top-0 start-66 translate-middle pt-6 fs-7 text-secondary"> 餐點準備中 </p><button type="button" class="position-absolute top-0 start-100 translate-middle btn btn-sm btn-third rounded-pill" style="width:1rem;height:1rem;"></button><p class="position-absolute top-0 start-100 translate-middle pt-6 fs-7 text-secondary text-nowrap"> 完成取餐 </p>',8);function dt(r,e,m,C,o,u){return n(),l("div",rt,[t("div",nt,[t("div",{class:"progress-bar bg-danger",role:"progressbar","aria-label":"Progress",style:L({width:u.progressBarWidth}),"aria-valuenow":u.progressBarValue,"aria-valuemin":"0","aria-valuemax":"100"},null,12,lt)]),it])}const ct=V(at,[["render",dt]]),{VITE_APP_URL:ut,VITE_APP_PATH:mt}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"2259buyer",BASE_URL:"/VueTraining_w7/",MODE:"production",DEV:!1,PROD:!0},pt={data(){return{isLoading:!0,form:{user:{name:"",tel:"",address:"take-out",email:"no-email"},message:"",orderStatus:""}}},methods:{createOrder(){const r=this.form;this.$http.post(`${ut}/v2/api/${mt}/order`,{data:r}).then(e=>{const{orderId:m}=e.data;this.$swal(e.data.message),this.$refs.form.resetForm(),this.$router.push(`/cartfinal/${m}`)}).catch(e=>{this.swalError(e)})},...b(h,["getCartData"]),...b(S,["swalError","swalToastTopEnd"])},computed:{...E(h,["carts","finalTotal"])},components:{FrontCart:ot,LoadingDesign:P,FrontCartBar:ct,ErrorMessage:B,VForm:I,Field:U},mounted(){this.getCartData("CartView"),this.isLoading=!1,document.title="鮮堡漢堡 文化店 | 購物車"}},_t={class:"w-100 position-relative z-2"},ht={class:"common-hero container"},bt={class:"row row-cols-1 row-cols-lg-2 p-1 pb-6"},ft={class:"col mt-2 mt-lg-5"},gt={class:"col"},wt={class:"row justify-content-center bg-third rounded rounded-4 rounded-lg-6 p-4 p-md-7"},vt=t("h2",{class:"mb-2 mb-lg-3"},"請輸入訂購資料",-1),yt={class:"mb-3"},xt=t("label",{for:"desk",class:"form-label"},"桌次",-1),$t=t("option",{value:"take-out"},"外帶",-1),Vt=t("option",{value:"1"},"1",-1),Ct=t("option",{value:"2"},"2",-1),kt=t("option",{value:"3"},"3",-1),St=t("option",{value:"5"},"5",-1),Et=t("option",{value:"6"},"6",-1),Ft=t("option",{value:"7"},"7",-1),Tt=t("option",{value:"8"},"8",-1),Lt=t("option",{value:"9"},"9",-1),At={class:"mb-3"},Dt=t("label",{for:"name",class:"form-label"},"訂購人姓名*",-1),Pt={class:"mb-3"},Bt=t("label",{for:"tel",class:"form-label"},"聯絡電話*",-1),It={class:"mb-3"},Ut=t("label",{for:"message",class:"form-label"},"備註留言",-1),Ot=t("div",{class:"text-center w-100"},[t("button",{type:"submit",class:"btn btn-danger w-100"},"送出訂單")],-1);function Rt(r,e,m,C,o,u){const f=d("LoadingDesign"),s=d("FrontCartBar"),k=d("FrontCart"),g=d("Field"),w=d("ErrorMessage"),F=d("VForm");return n(),l(x,null,[a(f,{"is-Loading":o.isLoading},null,8,["is-Loading"]),t("main",_t,[t("section",ht,[a(s,{currentState:"訂購資料"}),t("div",bt,[t("div",ft,[a(k)]),t("div",gt,[t("div",wt,[vt,a(F,{ref:"form",onSubmit:u.createOrder},{default:$(({errors:v})=>[t("div",yt,[xt,a(g,{id:"desk",name:"desk",as:"select",class:y(["form-select",{"is-invalid":v.桌號}]),modelValue:o.form.user.address,"onUpdate:modelValue":e[0]||(e[0]=i=>o.form.user.address=i)},{default:$(()=>[$t,Vt,Ct,kt,St,Et,Ft,Tt,Lt]),_:2},1032,["class","modelValue"]),a(w,{name:"桌號",class:"invalid-feedback"})]),t("div",At,[Dt,a(g,{id:"name",name:"姓名",type:"text",class:y(["form-control",{"is-invalid":v.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.form.user.name,"onUpdate:modelValue":e[1]||(e[1]=i=>o.form.user.name=i)},null,8,["class","modelValue"]),a(w,{name:"姓名",class:"invalid-feedback"})]),t("div",Pt,[Bt,a(g,{id:"tel",name:"電話",type:"tel",class:y(["form-control",{"is-invalid":v.電話}]),placeholder:"請輸入電話",rules:"required|min:8|max:10",modelValue:o.form.user.tel,"onUpdate:modelValue":e[2]||(e[2]=i=>o.form.user.tel=i)},null,8,["class","modelValue"]),a(w,{name:"電話",class:"invalid-feedback"})]),t("div",It,[Ut,D(t("textarea",{id:"message",name:"message",class:"form-control",placeholder:"如果有任何餐點製作需求，您可在此留言，我們將盡量配合。",cols:"30",rows:"10","onUpdate:modelValue":e[3]||(e[3]=i=>o.form.message=i)},null,512),[[O,o.form.message]])]),Ot]),_:1},8,["onSubmit"])])])])])])],64)}const Kt=V(pt,[["render",Rt]]);export{Kt as default};
