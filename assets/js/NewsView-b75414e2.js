import{v as $,l as k}from"./runtime-dom.esm-bundler-eb0e3820.js";import{b6 as b,aj as n,l as d,m as t,F as y,at as E,aJ as f,b3 as g,s as w,av as h,t as u}from"./_plugin-vue_export-helper-68081c38.js";import{A as x}from"./AdminPagination-ac3965f5.js";import{M as v}from"./modal-07befdcc.js";import{s as N}from"./useSweetAlertStore-8261f0c8.js";import{m as T}from"./index-f29d177b.js";import"./_commonjsHelpers-87174ba5.js";import"./base-component-3c0963ef.js";import"./vue-router-e29dd812.js";const D={props:["articles","openModal","changeState"]},C={class:"table table-hover mt-4"},V=t("thead",null,[t("tr",null,[t("th",{width:"200"},"最新消息內容"),t("th",{width:"100"},"建立日期"),t("th",{width:"100"},"是否啟用"),t("th",{width:"100"},"功能")])],-1),L={class:"form-check form-switch"},S=["onUpdate:modelValue"],U={class:"btn-group"},I=["onClick"],B=["onClick"];function H(s,e,l,A,o,i){return n(),d("table",C,[V,t("tbody",null,[(n(!0),d(y,null,E(l.articles,a=>(n(),d("tr",{key:a.id},[t("td",null,f(a.title),1),t("td",null,f(s.$moment(new Date(a.create_at)).format("YYYY-MM-DD HH:mm")),1),t("td",null,[t("div",L,[g(t("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"changeStatus","onUpdate:modelValue":c=>a.isPublic=c,"true-value":!0,"false-value":!1,onChange:e[0]||(e[0]=c=>l.changeState(s.product))},null,40,S),[[$,a.isPublic]])])]),t("td",null,[t("div",U,[t("button",{type:"button",class:"btn btn-outline-primary",onClick:c=>l.openModal("edit",a)}," 編輯 ",8,I),t("button",{type:"button",class:"btn btn-outline-danger",onClick:c=>l.openModal("delete",a)}," 刪除 ",8,B)])])]))),128))])])}const R=b(D,[["render",H]]),Y={props:["tempArticle","isNew","updateArticle","createImages"],template:"#product-modal-template"},j={id:"productModal",ref:"productModal",class:"modal fade",tabindex:"-1","aria-labelledby":"productModalLabel","aria-hidden":"true"},q={class:"modal-dialog modal-xl"},F={class:"modal-content border-0"},O={class:"modal-header bg-dark text-white"},J={id:"productModalLabel",class:"modal-title"},z={key:0,class:"lh-2"},G={key:1,class:"lh-2"},K=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Q={class:"modal-body"},W={class:"mb-3"},X=t("label",{for:"title",class:"form-label"},"內容",-1),Z={class:"mb-3"},tt={class:"form-check"},et=t("label",{class:"form-check-label",for:"isPublic"},"是否啟用",-1),st={class:"modal-footer"},lt=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function at(s,e,l,A,o,i){return n(),d("div",j,[t("div",q,[t("div",F,[t("div",O,[t("h5",J,[l.isNew?(n(),d("span",z,"新增最新消息")):(n(),d("span",G,"編輯 最新消息"))]),K]),t("div",Q,[t("div",W,[X,g(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=a=>l.tempArticle.title=a),type:"text",class:"form-control",placeholder:"請輸入顯示的訊息內容"},null,512),[[k,l.tempArticle.title]])]),t("div",Z,[t("div",tt,[g(t("input",{id:"isPublic","onUpdate:modelValue":e[1]||(e[1]=a=>l.tempArticle.isPublic=a),class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1},null,512),[[$,l.tempArticle.isPublic]]),et])])]),t("div",st,[lt,t("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=(...a)=>l.updateArticle&&l.updateArticle(...a))}," 確認 ")])])])],512)}const it=b(Y,[["render",at]]),ot={props:["tempArticle","delArticle"],template:"#del-modal-template"},nt={id:"delProductModal",ref:"delProductModal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},dt={class:"modal-dialog modal-dialog-centered"},ct={class:"modal-content border-0"},rt=t("div",{class:"modal-header bg-danger text-white"},[t("h5",{id:"delProductModalLabel",class:"modal-title"},[t("span",null,"刪除最新消息")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),mt={class:"modal-body"},ht={class:"text-danger"},ut=t("br",null,null,-1),pt={class:"modal-footer"},_t=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function bt(s,e,l,A,o,i){return n(),d("div",nt,[t("div",dt,[t("div",ct,[rt,t("div",mt,[w(" 是否刪除 "),t("strong",ht,f(l.tempArticle.title),1),ut,w("(刪除後將無法恢復)。 ")]),t("div",pt,[_t,t("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=(...a)=>l.delArticle&&l.delArticle(...a))}," 確認刪除 ")])])])],512)}const At=b(ot,[["render",bt]]),{VITE_APP_URL:r,VITE_APP_PATH:m}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"2259buyer",BASE_URL:"/VueTraining_w7/",MODE:"production",DEV:!1,PROD:!0};let p="",_="";const ft={data(){return{articles:[],tempArticle:{},isNew:!1,pageData:{}}},methods:{getArticles(s=1){this.$http.get(`${r}/v2/api/${m}/admin/articles?page=${s}`).then(e=>{this.articles=e.data.articles,this.pageData=e.data.pagination}).catch(e=>{this.loginCheckError(e.response.data.message)})},productDetail(s){this.tempAtricle=s},updateArticle(){let s=`${r}/v2/api/${m}/admin/article`,e="post";this.tempArticle.content="首頁最新消息",this.isNew&&(this.tempArticle.create_at=Date.now(),this.tempArticle.author="Admin",this.tempArticle.isPublic=!0),this.isNew||(s=`${r}/v2/api/${m}/admin/article/${this.tempArticle.id}`,e="put"),this.$http[e](s,{data:this.tempArticle}).then(l=>{this.swalToastTopEnd(l.data.message),p.hide(),this.getArticles()}).catch(l=>{this.swalError(l.response.data.message)})},delArticle(){this.$http.delete(`${r}/v2/api/${m}/admin/article/${this.tempArticle.id}`).then(s=>{this.swalToastTopEnd(s.data.message),_.hide(),this.getArticles()}).catch(s=>{this.swalError(s.response.data.message),_.hide()})},changeState(s){this.$http.put(`${r}/v2/api/${m}/admin/article/${s.id}`,{data:s}).then(e=>{this.swalToastTopEnd(e.data.message),this.getArticles()}).catch(e=>{this.swalError(e.response.data.message)})},createImages(){this.tempAtricle.imagesUrl=[],this.tempAtricle.imagesUrl.pus("")},openModal(s,e){s==="new"?(this.tempArticle={},this.isNew=!0,p.show()):s==="edit"?(this.tempArticle={...e},this.isNew=!1,p.show()):s==="delete"&&(this.tempArticle={...e},_.show())},...T(N,["swalError","swalToastTopEnd","loginCheckError"])},components:{AdminNewsList:R,AdminNewsModal:it,AdminDelProductModal:At,AdminPagination:x},mounted(){this.getArticles(),p=new v(document.querySelector("#productModal"),{keyboard:!1}),_=new v(document.querySelector("#delProductModal"),{keyboard:!1}),document.title="最新消息管理 | 鮮堡漢堡 文化店"}},gt={class:"container"},wt={class:"row py-3"},vt={class:"d-flex align-items-center justify-content-between"},$t=t("h3",{class:"ls-2"},"最新消息管理",-1),yt={class:"d-flex justify-content-center"};function Mt(s,e,l,A,o,i){const a=h("AdminNewsList"),c=h("AdminPagination"),M=h("AdminNewsModal"),P=h("AdminDelProductModal");return n(),d(y,null,[t("div",gt,[t("div",wt,[t("div",null,[t("div",vt,[$t,t("button",{onClick:e[0]||(e[0]=Pt=>i.openModal("new")),type:"button",class:"btn btn-primary"}," 新增消息 ")]),u(a,{articles:o.articles,"open-modal":i.openModal,"change-state":i.changeState},null,8,["articles","open-modal","change-state"]),t("div",yt,[u(c,{"page-data":o.pageData,"get-datas":i.getArticles},null,8,["page-data","get-datas"])])])])]),u(M,{"temp-article":o.tempArticle,"is-new":o.isNew,"update-article":i.updateArticle},null,8,["temp-article","is-new","update-article"]),u(P,{"temp-article":o.tempArticle,"del-article":i.delArticle},null,8,["temp-article","del-article"])],64)}const St=b(ft,[["render",Mt]]);export{St as default};
