import{m,a as C}from"./pinia-a993d8e5.js";import{c as y}from"./useCartStore-ff08fbc7.js";import{s as k}from"./useSweetAlertStore-029ecf06.js";import{v}from"./runtime-dom.esm-bundler-cc91c085.js";import{_ as x,k as T,l as n,V as a,W as t,a0 as f,a3 as b,$ as c,a4 as p,Y as A,Z as P,a5 as S,a1 as _}from"./_plugin-vue_export-helper-705f5c90.js";import"./index-e4375e55.js";import"./vue-router-3209099d.js";const{VITE_APP_URL:w,VITE_APP_PATH:g}={VITE_APP_URL:"https://vue3-course-api.hexschool.io",VITE_APP_PATH:"2259buyer",BASE_URL:"/VueTraining_w7/",MODE:"production",DEV:!1,PROD:!0},E={data(){return{categorys:["精選套餐","現烤總匯","漢堡","現烤三明治","蛋餅、河粉蛋餅","中西式點心"],selectedCategorys:[],selectdeProducts:[],checkAll:!1,canStartLottery:!1,winner:null,products:[],productID:"",loadingItem:""}},methods:{onCheckAllChange(){this.selectedCategorys=this.checkAll?[...this.categorys]:[]},watchSelectedCategorys(){this.selectedCategorys.length===0||this.selectedCategorys.length===this.categorys.length?this.checkAll=!0:this.checkAll=!1},startLottery(){let s=20;const o=2e3,h=20,d=100;let r=0;const l=setInterval(()=>{const u=Math.floor(Math.random()*this.products.length),e=this.products[u];if(this.winner=e,console.log(l,this.winner),r<d&&(s+=h,r++),s>=o){clearInterval(l);const{id:i}=this.winner;this.addToCart(i)}},s)},getProduct(){this.$http.get(`${w}/v2/api/${g}/products/all`).then(s=>{this.products=s.data.products}).catch(s=>{this.swalError(s)})},addToCart(s,o=1){const h={product_id:s,qty:o,message:"抽抽樂抽到的"};this.$http.post(`${w}/v2/api/${g}/cart`,{data:h}).then(d=>{this.swalToastTopEnd("已幫您自動加入購物車"),this.getCartData()}).catch(d=>{this.swalError(d)})},...m(y,["getCartData","addToCart","deleteOneCart","swalClearAllCart"]),...m(k,["swalError","swalToastTopEnd"])},computed:{...C(y,["finalTotal","carts"])},mounted(){this.getProduct(),this.getCartData(),document.title="鮮堡漢堡 文化店 | 早餐轉轉轉"}},V={class:"w-100 position-relative z-2"},I=t("section",{class:"common-hero container"},[t("h2",{class:"mb-1ls-2 text-sm-start text-center"}," 不知道吃什麼嗎？我也許能幫忙！ "),t("h1",{class:"text-secondary text-nowrap font-monospace text-uppercase mb-1"}," make life smoother ")],-1),D={class:"container"},L={class:"row row-cols-1 row-cols-lg-2 p-1 pb-6"},U={class:"col"},B={class:"row justify-content-center bg-third rounded rounded-4 rounded-lg-5 p-4 p-md-6"},M=t("h5",null,"有特別想要的餐點類別嗎？（預設全選）",-1),N={class:"form-group mb-2"},O=t("div",{class:"form-check"},null,-1),R=["id","value"],j=["for"],H={key:0,class:"mt-5 fs-5"},q={class:"col"},z={class:"table align-middle w-100 border-secondary p-2"},F=t("thead",null,[t("tr",{class:"w-100"},[t("th",null,"品名"),t("th",{class:"text-nowrap text-center"},"單價"),t("th",{class:"text-nowrap text-center"},"數量"),t("th",{class:"text-nowrap text-center"},"小計"),t("th")])],-1),W={class:"w-100"},Y={key:0,class:"text-success"},Z={class:"text-center"},$={class:"text-center"},G={class:"text-center"},J=["onClick","disabled"],K={key:0,class:"fas fa-spinner fa-pulse"},Q={class:"border-transparent"},X=t("td",{colspan:"4",class:"text-end border-0"},"總計",-1),tt={class:"text-end border-0"},et={class:"d-flex justify-content-between mb-4"};function st(s,o,h,d,r,l){const u=T("router-link");return n(),a("main",V,[I,t("section",D,[t("div",L,[t("div",U,[t("div",B,[M,t("div",N,[O,(n(!0),a(f,null,b(r.categorys,e=>(n(),a("div",{class:"form-check",key:e},[S(t("input",{class:"form-check-input",type:"checkbox",id:e,value:e,"onUpdate:modelValue":o[0]||(o[0]=i=>r.selectedCategorys=i),onChange:o[1]||(o[1]=(...i)=>l.watchSelectedCategorys&&l.watchSelectedCategorys(...i))},null,40,R),[[v,r.selectedCategorys]]),t("label",{class:"form-check-label",for:e},c(e),9,j)]))),128))]),t("button",{class:"btn btn-primary",onClick:o[2]||(o[2]=(...e)=>l.startLottery&&l.startLottery(...e))},"按我開始，決定今天吃什麼 "),r.winner?(n(),a("div",H," 您覺得今天吃 『 "+c(r.winner.mainTitle)+" 』 好嗎？ ",1)):p("",!0)])]),t("div",q,[t("table",z,[F,t("tbody",W,[s.carts?(n(!0),a(f,{key:0},b(s.carts,e=>(n(),a("tr",{key:e.id},[t("td",null,[_(c(e.product.title)+" ",1),e.coupon?(n(),a("div",Y," 已套用優惠券 ")):p("",!0)]),t("td",Z,c(e.product.price),1),t("td",$,c(e.qty),1),t("td",G,c(e.total),1),t("td",null,[t("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:i=>s.deleteOneCart(e.id),disabled:e.id===r.loadingItem},[r.loadingItem===e.id?(n(),a("i",K)):p("",!0),_(" x ")],8,J)])]))),128)):p("",!0)]),t("tfoot",Q,[t("tr",null,[X,t("td",tt,c(s.finalTotal),1)])])]),t("div",et,[t("button",{class:"btn btn-danger",type:"button",onClick:o[3]||(o[3]=(...e)=>s.swalClearAllCart&&s.swalClearAllCart(...e))}," 清空商品 "),A(u,{class:"btn btn-secondary",type:"button",to:"/products"},{default:P(()=>[_("想點更多")]),_:1})])])])])])}const dt=x(E,[["render",st]]);export{dt as default};
